import{S as z,i as B,s as G,t as _,$ as J,k as K,l as E,g as y,a0 as L,n as W,f as b,h as Q,e as X,c as Y,a as Z,d as m,b as v,H as F,O as R,M as T}from"./vendor-9a64f523.js";import{s as x}from"./stores-bd9665ba.js";import{f as p}from"./store-b78dac0d.js";function g(s){let l,e,n,c,o,r,f=s[0]&&s[2]&&P(s);return{c(){l=_("Now cleaning up the "),e=_(s[1]),n=_(`.
  `),c=new J,o=K(),f&&f.c(),r=E(),this.h()},l(i){l=y(i,"Now cleaning up the "),e=y(i,s[1]),n=y(i,`.
  `),c=L(i),o=W(i),f&&f.l(i),r=E(),this.h()},h(){c.a=o},m(i,u){b(i,l,u),b(i,e,u),b(i,n,u),c.m(ee,i,u),b(i,o,u),f&&f.m(i,u),b(i,r,u)},p(i,u){u&2&&Q(e,i[1]),i[0]&&i[2]?f?f.p(i,u):(f=P(i),f.c(),f.m(r.parentNode,r)):f&&(f.d(1),f=null)},d(i){i&&m(l),i&&m(e),i&&m(n),i&&c.d(),i&&m(o),f&&f.d(i),i&&m(r)}}}function P(s){let l,e,n,c;return{c(){l=X("div"),e=_("The "),n=_(s[1]),c=_(" are cleared"),this.h()},l(o){l=Y(o,"DIV",{"data-test":!0});var r=Z(l);e=y(r,"The "),n=y(r,s[1]),c=y(r," are cleared"),r.forEach(m),this.h()},h(){v(l,"data-test","complete")},m(o,r){b(o,l,r),F(l,e),F(l,n),F(l,c)},p(o,r){r&2&&Q(n,o[1])},d(o){o&&m(l)}}}function $(s){let l,e=(s[3].environment==="cypress"||s[3].environment==="test"||s[3].environment==="development")&&g(s);return{c(){e&&e.c(),l=E()},l(n){e&&e.l(n),l=E()},m(n,c){e&&e.m(n,c),b(n,l,c)},p(n,[c]){n[3].environment==="cypress"||n[3].environment==="test"||n[3].environment==="development"?e?e.p(n,c):(e=g(n),e.c(),e.m(l.parentNode,l)):e&&(e.d(1),e=null)},i:R,o:R,d(n){e&&e.d(n),n&&m(l)}}}let ee="<br> feedback: <br>";function te(s,l,e){let n,c;T(s,p,t=>e(16,n=t)),T(s,x,t=>e(3,c=t));let{collection:o}=l,{userCheck:r=!0}=l,{fieldUserId:f="authorId"}=l,{idCheck:i=!1}=l,{subcollectionDelete:u=!1}=l,{subcollection:A}=l,{ids:k}=l,{checkAnon:N=!0}=l,{uid:C=null}=l,{titleCheck:U=!1}=l,{title:I=null}=l,w,{resetDone:S=!1}=l,{showComplete:H=!0}=l,h;async function M(){try{if(c.user.uid){let t=h.collection(o);r&&(C==null&&e(4,C=c.user.uid),t=h.collection(o).where(f,"==",C)),i&&k&&k.length>0&&(t=h.collection(o).where(w.firestore.FieldPath.documentId(),"in",k)),U&&I!==null&&(t=h.collection(o).where("title","==",I));let j=await t.get(),d=[];j.forEach(a=>{d.push(a.id)}),console.log(d);for(let a=0;a<d.length;a++)await h.collection(o).doc(d[a]).delete()}}catch(t){console.error(t)}e(0,S=!0)}async function O(){try{if(c.user.uid){let j=await h.collection(o).get(),d=[];j.forEach(a=>{d.push(a.id)});for(let a=0;a<d.length;a++){let V=await h.collection(o).doc(d[a]).collection(A).where(w.firestore.FieldPath.documentId(),"in",k).get(),q=[];V.forEach(D=>{q.push(D.id)});for(let D=0;D<q.length;D++)await h.collection(o).doc(d[a]).collection(A).doc(q[D]).delete()}}}catch(t){console.error(t)}e(0,S=!0)}return s.$$set=t=>{"collection"in t&&e(1,o=t.collection),"userCheck"in t&&e(5,r=t.userCheck),"fieldUserId"in t&&e(6,f=t.fieldUserId),"idCheck"in t&&e(7,i=t.idCheck),"subcollectionDelete"in t&&e(8,u=t.subcollectionDelete),"subcollection"in t&&e(9,A=t.subcollection),"ids"in t&&e(10,k=t.ids),"checkAnon"in t&&e(11,N=t.checkAnon),"uid"in t&&e(4,C=t.uid),"titleCheck"in t&&e(12,U=t.titleCheck),"title"in t&&e(13,I=t.title),"resetDone"in t&&e(0,S=t.resetDone),"showComplete"in t&&e(2,H=t.showComplete)},s.$$.update=()=>{s.$$.dirty&81920&&(async()=>{n&&(e(14,w=n),e(15,h=await w.firestore()))})(),s.$$.dirty&35080&&(async()=>{(c.environment==="cypress"||c.environment==="test"||c.environment==="development")&&h&&c.player&&c.user&&(!N||!c.user.isAnonymous)&&(u?await O():await M())})()},[S,o,H,c,C,r,f,i,u,A,k,N,U,I,w,h,n]}class oe extends z{constructor(l){super();B(this,l,te,$,G,{collection:1,userCheck:5,fieldUserId:6,idCheck:7,subcollectionDelete:8,subcollection:9,ids:10,checkAnon:11,uid:4,titleCheck:12,title:13,resetDone:0,showComplete:2})}}export{oe as C};
