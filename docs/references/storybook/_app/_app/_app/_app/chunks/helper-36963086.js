var m=Object.defineProperty;var g=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var h=(e,i,t)=>i in e?m(e,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[i]=t,p=(e,i)=>{for(var t in i||(i={}))v.call(i,t)&&h(e,t,i[t]);if(g)for(var t of g(i))A.call(i,t)&&h(e,t,i[t]);return e};import{g as M}from"./helper-69e97bf9.js";function L(e,i,t){let o=6,l=[],a=I(e,i).map(n=>n.id);a.length>o&&(o=a.length);for(let n=0;n<t.selectedActivities.length;n++){let r=t.selectedActivities[n];a.includes(r.goalId)&&l.push(r)}let c=[],d=!1,f=0;for(;!d;){c.length==o-1&&(d=!0),l.length===0&&(d=!0);let n=a[f];for(let r=0;r<l.length;r++)if(l[r].goalId===n){c.push(l[r]),l.splice(r,1);break}f++,f==a.length&&(f=0)}return c}function b(e,i=!1,t=!0,o=!0){let l={moduleName:e.moduleName,moduleDescription:e.moduleDescription,moduleSvg:e.moduleSvg},s,a=!1;if(o?e.map&&(s=e.map,a=!0):e.mapId&&(s=e,a=!0),a){let c=M(s,t);c.mapId=s.mapId,l=p(p({},l),c),i&&(l.map=e.map)}return l}function I(e,i){let t=[];if(e.locations)for(let o=0;o<e.locations.length;o++){let l=e.locations[o];if(l.id===i){t=l.goals;break}}return t}async function D(e,i){let o=await e.collection("modules").where("authorId","==",i).orderBy("modifiedAt","desc").get(),l=[];return o.forEach(s=>{let a=s.data();a.id=s.id,l.push(a)}),l}async function y(e,i,t,o){let l=await e.firestore(),s=null;if(o&&t)try{const c=await l.collection("modules/"+i+"/players").doc(o.id).get({source:"server"});if(c.exists)s=c.data(),s.id=o.id;else{let d=[];for(let u=0;u<t.locations.length;u++)t.locations[u].isStartLocation&&d.push(t.locations[u].id);let f={unlockedLocations:d,succeededLocations:[],selectedAdventures:[],selectedActivities:[],id:o.id},r=await l.collection("modules/"+i+"/players").doc(o.id).set(f);s=f}}catch(a){console.log(a)}return s}export{L as a,b as f,y as g,D as r};
