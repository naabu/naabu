import{S as C,i as R,s as D,t as _,$ as N,k as A,l as d,g as h,a0 as I,n as P,f as u,e as j,c as H,a as V,d as c,b as F,H as q,O as w,M as k,N as E}from"../../../chunks/vendor-9a64f523.js";import{s as S}from"../../../chunks/stores-bd9665ba.js";import{f as L}from"../../../chunks/store-b78dac0d.js";function G(i){let r,e,t,s,o=i[1]&&T();return{c(){r=_(`Now setting up the learning goals
  `),e=new N,t=A(),o&&o.c(),s=d(),this.h()},l(l){r=h(l,`Now setting up the learning goals
  `),e=I(l),t=P(l),o&&o.l(l),s=d(),this.h()},h(){e.a=t},m(l,a){u(l,r,a),e.m(i[2],l,a),u(l,t,a),o&&o.m(l,a),u(l,s,a)},p(l,a){a&4&&e.p(l[2]),l[1]?o||(o=T(),o.c(),o.m(s.parentNode,s)):o&&(o.d(1),o=null)},d(l){l&&c(r),l&&e.d(),l&&c(t),o&&o.d(l),l&&c(s)}}}function T(i){let r,e;return{c(){r=j("div"),e=_("learning goal ready for testing"),this.h()},l(t){r=H(t,"DIV",{"data-test":!0});var s=V(r);e=h(s,"learning goal ready for testing"),s.forEach(c),this.h()},h(){F(r,"data-test","complete")},m(t,s){u(t,r,s),q(r,e)},d(t){t&&c(r)}}}function M(i){let r,e=(i[0].environment==="cypress"||i[0].environment==="test"||i[0].environment==="development")&&G(i);return{c(){e&&e.c(),r=d()},l(t){e&&e.l(t),r=d()},m(t,s){e&&e.m(t,s),u(t,r,s)},p(t,[s]){t[0].environment==="cypress"||t[0].environment==="test"||t[0].environment==="development"?e?e.p(t,s):(e=G(t),e.c(),e.m(r.parentNode,r)):e&&(e.d(1),e=null)},i:w,o:w,d(t){e&&e.d(t),t&&c(r)}}}function O(i,r,e){let t,s;k(i,L,f=>e(5,t=f)),k(i,S,f=>e(0,s=f));let o,l=!1,a,n="<br> feedback: <br>";async function v(){if(!s.player.curriculumProfileId){e(2,n+="creating a profile <br>");let p={fullname:"Cypress test user",uid:s.user.uid},m=await a.collection("curriculumProfile").add(p);E(S,s.player.curriculumProfileId=m.id,s),await a.collection("players").doc(s.user.uid).update({curriculumProfileId:m.id}),e(2,n+="profile created "+m.id+"<br>")}let f=a.collection("goals").doc("cypress-test-goal-1"),g=a.collection("goals").doc("cypress-test-goal-2");try{e(2,n+="Getting goal snap <br>");let p=await f.get(),b=await g.get();p.exists&&(e(2,n+="Goal 1 exists deleting <br>"),await f.delete(),e(2,n+="Goal 1 deleted <br>")),b.exists&&(e(2,n+="Goal 2 exists deleting <br>"),await g.delete(),e(2,n+="Goal 2 deleted <br>"));let m={title:"Cypress Test Goal 1",description:"This is a test goal for Cypress",createdAt:o.firestore.FieldValue.serverTimestamp()};e(2,n+="Set goal 1 <br>"),await f.set(m),e(2,n+="Set goal 1 complete <br>");let y={title:"Cypress Test Goal 2",description:"This is a test goal for Cypress",createdAt:o.firestore.FieldValue.serverTimestamp()};e(2,n+="Set goal 2 <br>"),await g.set(y),e(2,n+="Set goal 2 complete <br>"),e(1,l=!0)}catch(p){console.error(p)}}return i.$$.update=()=>{i.$$.dirty&40&&(async()=>{t&&(e(3,o=t),e(4,a=await o.firestore()))})(),i.$$.dirty&17&&(async()=>{(s.environment==="cypress"||s.environment==="test"||s.environment==="development")&&a&&s.player&&s.user&&!s.user.isAnonymous&&await v()})()},[s,l,n,o,a,t]}class J extends C{constructor(r){super();R(this,r,O,M,D,{})}}export{J as default};
