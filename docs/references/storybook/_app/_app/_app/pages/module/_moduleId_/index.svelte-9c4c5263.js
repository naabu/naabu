import{S as N,i as Z,s as D,e as S,k as R,X as J,c as q,a as U,d as k,n as V,b,F as x,H as Y,f as j,O as E,M as F,A as $,Y as T,Z as O,j as K,l as W,m as G,o as Q,_ as X,u as B,w as ee,x as P,v as z,r as te,t as oe,g as ne}from"../../../chunks/vendor-ef0a5b69.js";import{_ as se}from"../../../chunks/preload-helper-ec9aa979.js";import{g as H}from"../../../chunks/navigation-51f4a605.js";import{s as ie,p as ae}from"../../../chunks/stores-2d9a71bb.js";/* empty css                                                         */import{G as le}from"../../../chunks/getModuleData-14804e35.js";import"../../../chunks/singletons-12a22614.js";import"../../../chunks/store-6c10047c.js";import"../../../chunks/helper-36963086.js";import"../../../chunks/helper-69e97bf9.js";function re(l){let o,e,u,r,i;return{c(){o=S("link"),e=S("script"),r=R(),i=S("div"),this.h()},l(t){const a=J('[data-svelte="svelte-tw7sez"]',document.head);o=q(a,"LINK",{rel:!0,href:!0,integrity:!0,crossorigin:!0}),e=q(a,"SCRIPT",{src:!0,integrity:!0,crossorigin:!0});var n=U(e);n.forEach(k),a.forEach(k),r=V(t),i=q(t,"DIV",{id:!0,class:!0}),U(i).forEach(k),this.h()},h(){b(o,"rel","stylesheet"),b(o,"href","https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"),b(o,"integrity","sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="),b(o,"crossorigin",""),x(e.src,u="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js")||b(e,"src",u),b(e,"integrity","sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="),b(e,"crossorigin",""),b(i,"id","map"),b(i,"class","svelte-80p5vw")},m(t,a){Y(document.head,o),Y(document.head,e),j(t,r,a),j(t,i,a)},p:E,i:E,o:E,d(t){k(o),k(e),t&&k(r),t&&k(i)}}}function ue(l,o,e){let u;F(l,ie,c=>e(9,u=c));let{map:r}=o,{userMap:i}=o,t,a,n,p=!1,h=!1,{isModule:L=!1}=o;function w(c){L?H("/module/"+r.id+"/locatie/"+c.id):H("/kaart/"+r.id+"/locatie/"+c.id)}$(async()=>{{n=(await se(()=>import("../../../chunks/leaflet-src-3947d5e4.js").then(function(m){return m.l}),["chunks/leaflet-src-3947d5e4.js","chunks/vendor-ef0a5b69.js","assets/vendor-d601917d.css"])).default,a=[[0,0],[963,1286]];var c=n.latLng(0,0),f=n.latLng(963,1286),_=n.latLngBounds(c,f);t=n.map("map",{crs:n.CRS.Simple,maxZoom:2,doubleClickZoom:!1,maxBounds:_}),t.fitBounds(a),t.on("drag",function(){t.panInsideBounds(a,{animate:!1})}),await n.imageOverlay(r.image,a).addTo(t)}e(3,p=!0)});function d(){if(u.player){let c=n.tooltip({direction:"center",permanent:!0,interactive:!0,noWrap:!0,opacity:1});c.setLatLng([870,140]),c.setContent(r.title),c.addTo(t);for(let f=0;f<r.locations.length;f++){let _=r.locations[f],s=!1;u.player&&i&&i.unlockedLocations.includes(_.id)&&(s=!0);let m=_.textPositionX,v=_.textPositionY,y=_.markerPositionX,A=_.markerPositionY,I=n.tooltip({direction:"center",permanent:!0,interactive:!0,noWrap:!0,opacity:1}).setLatLng([v,m]).setContent(_.name);if(I.addTo(t),s){let g=I.getElement();g.addEventListener("click",function(){w(_)}),g.style.pointerEvents="auto",g.style.cursor="pointer"}n.icon({iconUrl:"/map-icon1.svg",iconAnchor:[12,12]});for(let g=0;g<r.paths.length;g++){let M=r.paths[g];if(i&&i.unlockedLocations.includes(M.endLocation)){let C=M.points;n.polyline(C,{color:"#EB7B02",dashArray:"7 12",weight:5,lineCap:"round",lineJoin:"round"}).addTo(t).bringToBack()}}if(s){n.icon({iconUrl:"/map-icon1-unlocked.svg",iconSize:[36,36]});let g=n.circle([A,y],18,{color:"#707070",weight:1,opacity:1,fillColor:"#9ECBFF",fillOpacity:1,className:"unlocked_marker_"+f}),M=n.circle([A,y],5,{color:"#707070",weight:1,opacity:1,fillColor:"#7D92FF",fillOpacity:1,className:"unlocked_marker_"+f+"-inner"});g.on("click",function(){w(_)}),M.on("click",function(){w(_)}),g.addTo(t),M.addTo(t)}else{let g=n.circle([A,y],18,{color:"#707070",weight:1,opacity:1,fillColor:"#4A495E",fillOpacity:1,className:"locked_marker_"+f}),M=n.circle([A,y],5,{color:"#707070",weight:1,opacity:1,fillColor:"#1C1D1A",fillOpacity:1});g.addTo(t),M.addTo(t);let C=g.getElement();C.style.pointerEvents="auto",C.style.cursor="grab",C=M.getElement(),C.style.pointerEvents="auto",C.style.cursor="grab"}}}}return l.$$set=c=>{"map"in c&&e(0,r=c.map),"userMap"in c&&e(1,i=c.userMap),"isModule"in c&&e(2,L=c.isModule)},l.$$.update=()=>{l.$$.dirty&26&&i&&p&&!h&&(e(4,h=!0),d())},[r,i,L,p,h]}class ce extends N{constructor(o){super();Z(this,o,ue,re,D,{map:0,userMap:1,isModule:2})}}function de(l){let o;return{c(){o=oe("Loading...")},l(e){o=ne(e,"Loading...")},m(e,u){j(e,o,u)},p:E,i:E,o:E,d(e){e&&k(o)}}}function fe(l){let o,e,u,r;function i(n){l[8](n)}function t(n){l[9](n)}let a={isModule:"true"};return l[1]!==void 0&&(a.map=l[1]),l[2]!==void 0&&(a.userMap=l[2]),o=new ce({props:a}),T.push(()=>O(o,"map",i)),T.push(()=>O(o,"userMap",t)),{c(){K(o.$$.fragment)},l(n){G(o.$$.fragment,n)},m(n,p){Q(o,n,p),r=!0},p(n,p){const h={};!e&&p&2&&(e=!0,h.map=n[1],X(()=>e=!1)),!u&&p&4&&(u=!0,h.userMap=n[2],X(()=>u=!1)),o.$set(h)},i(n){r||(P(o.$$.fragment,n),r=!0)},o(n){B(o.$$.fragment,n),r=!1},d(n){z(o,n)}}}function pe(l){let o,e,u,r,i,t,a,n,p;function h(s){l[5](s)}function L(s){l[6](s)}function w(s){l[7](s)}let d={};l[0]!==void 0&&(d.firebase=l[0]),l[1]!==void 0&&(d.module=l[1]),l[2]!==void 0&&(d.userModule=l[2]),o=new le({props:d}),T.push(()=>O(o,"firebase",h)),T.push(()=>O(o,"module",L)),T.push(()=>O(o,"userModule",w));const c=[fe,de],f=[];function _(s,m){return s[1]&&s[1].mapId?0:1}return t=_(l),a=f[t]=c[t](l),{c(){K(o.$$.fragment),i=R(),a.c(),n=W()},l(s){G(o.$$.fragment,s),i=V(s),a.l(s),n=W()},m(s,m){Q(o,s,m),j(s,i,m),f[t].m(s,m),j(s,n,m),p=!0},p(s,[m]){const v={};!e&&m&1&&(e=!0,v.firebase=s[0],X(()=>e=!1)),!u&&m&2&&(u=!0,v.module=s[1],X(()=>u=!1)),!r&&m&4&&(r=!0,v.userModule=s[2],X(()=>r=!1)),o.$set(v);let y=t;t=_(s),t===y?f[t].p(s,m):(te(),B(f[y],1,1,()=>{f[y]=null}),ee(),a=f[t],a?a.p(s,m):(a=f[t]=c[t](s),a.c()),P(a,1),a.m(n.parentNode,n))},i(s){p||(P(o.$$.fragment,s),P(a),p=!0)},o(s){B(o.$$.fragment,s),B(a),p=!1},d(s){z(o,s),s&&k(i),f[t].d(s),s&&k(n)}}}function me(l,o,e){let u;F(l,ae,d=>e(4,u=d));let r,i,t;""+u.params.id;let a=!1;function n(d){r=d,e(0,r)}function p(d){i=d,e(1,i)}function h(d){t=d,e(2,t),e(3,a),e(0,r),e(4,u)}function L(d){i=d,e(1,i)}function w(d){t=d,e(2,t),e(3,a),e(0,r),e(4,u)}return l.$$.update=()=>{l.$$.dirty&2&&i&&i.title!==i.moduleName&&e(1,i.title=i.moduleName,i),l.$$.dirty&29&&t&&!a&&(e(3,a=!0),e(2,t.newUnlockedLocation=!1,t),r.firestore().collection("modules/"+u.params.moduleId+"/players").doc(t.id).update({newUnlockedLocation:!1}))},[r,i,t,a,u,n,p,h,L,w]}class ve extends N{constructor(o){super();Z(this,o,me,pe,D,{})}}export{ve as default};
