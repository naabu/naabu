import{S as Pe,i as qe,s as Ae,a3 as Ue,e as w,j as J,k as V,L as Ge,t as fe,c as k,a as _,m as Q,n as C,M as He,d as g,g as ue,b as p,f as ce,o as U,F as u,G as Oe,H as xe,_ as H,x as D,u as S,v as x,l as de,r as We,w as Ne,K as ke,A as $e,Y as O,Z as W}from"../../../chunks/vendor-05d04a9e.js";import{s as et,p as tt}from"../../../chunks/stores-e07732fe.js";import{F as st}from"../../../chunks/form-cce74b52.js";import{B as rt}from"../../../chunks/Button-e99ba711.js";import{R as it}from"../../../chunks/revision-7e827e10.js";import{R as at}from"../../../chunks/resultFeedback-d6392221.js";import{g as ot,c as lt}from"../../../chunks/helper-d6a45b8d.js";import{f as nt}from"../../../chunks/store-fa4e989c.js";import{B as ft}from"../../../chunks/breadcrumbPageTitle-29d2ecc5.js";import"../../../chunks/quizzesForm-3f7b1543.js";import"../../../chunks/dialog-24821939.js";import"../../../chunks/helper-a37f5850.js";/* empty css                                                           */import"../../../chunks/tabs-01b39912.js";import"../../../chunks/navigation-51f4a605.js";import"../../../chunks/singletons-12a22614.js";import"../../../chunks/show-2c607e3f.js";function Ye(a){let o,e,i,r,n,d,b,l,t,f,z,I,T,R,s,h,c,v,j,y,L,P,ie,M,me,ge,$,N,Y,q,K,pe,be,ee,_e,B,F,he,ve,X,Z,A,te,we,je;function Ze(m){a[8](m)}let Ee={subSelected:"edit"};a[1]!==void 0&&(Ee.revision=a[1]),e=new it({props:Ee}),O.push(()=>W(e,"revision",Ze));function Je(m){a[9](m)}let ze={};a[2]!==void 0&&(ze.alert=a[2]),M=new at({props:ze}),O.push(()=>W(M,"alert",Je));function Qe(m){a[10](m)}let Ie={};return a[1]!==void 0&&(Ie.goal=a[1]),F=new st({props:Ie}),O.push(()=>W(F,"goal",Qe)),A=new rt({props:{isSubmit:!0,color:"primary",content:"Leerdoel publiseren"}}),{c(){o=w("div"),J(e.$$.fragment),r=V(),n=w("div"),d=w("div"),b=w("div"),l=Ge("svg"),t=Ge("path"),f=V(),z=w("div"),I=w("h3"),T=fe("Waarschuwing: u bewerkt een oude versie van deze pagina."),R=V(),s=w("div"),h=w("p"),c=fe(`Als u uw bewerking opslaat, gaan alle wijzigingen verloren die na
              deze versie zijn gemaakt.`),v=V(),j=w("p"),y=w("a"),L=fe("bewerk huidige versie"),ie=V(),J(M.$$.fragment),ge=V(),$=w("div"),N=w("div"),Y=w("div"),q=w("div"),K=w("h3"),pe=fe("Leerdoel wijzigen"),be=V(),ee=w("p"),_e=V(),B=w("form"),J(F.$$.fragment),ve=V(),X=w("div"),Z=w("div"),J(A.$$.fragment),this.h()},l(m){o=k(m,"DIV",{});var E=_(o);Q(e.$$.fragment,E),r=C(E),n=k(E,"DIV",{class:!0});var se=_(n);d=k(se,"DIV",{class:!0});var G=_(d);b=k(G,"DIV",{class:!0});var re=_(b);l=He(re,"svg",{class:!0,xmlns:!0,viewBox:!0,fill:!0,"aria-hidden":!0});var ye=_(l);t=He(ye,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),_(t).forEach(g),ye.forEach(g),re.forEach(g),f=C(G),z=k(G,"DIV",{class:!0});var ae=_(z);I=k(ae,"H3",{class:!0,"data-test":!0});var Re=_(I);T=ue(Re,"Waarschuwing: u bewerkt een oude versie van deze pagina."),Re.forEach(g),R=C(ae),s=k(ae,"DIV",{class:!0});var oe=_(s);h=k(oe,"P",{});var De=_(h);c=ue(De,`Als u uw bewerking opslaat, gaan alle wijzigingen verloren die na
              deze versie zijn gemaakt.`),De.forEach(g),v=C(oe),j=k(oe,"P",{});var Ve=_(j);y=k(Ve,"A",{class:!0,href:!0});var Ce=_(y);L=ue(Ce,"bewerk huidige versie"),Ce.forEach(g),Ve.forEach(g),oe.forEach(g),ae.forEach(g),G.forEach(g),se.forEach(g),ie=C(E),Q(M.$$.fragment,E),ge=C(E),$=k(E,"DIV",{});var Se=_($);N=k(Se,"DIV",{class:!0});var Te=_(N);Y=k(Te,"DIV",{class:!0});var Me=_(Y);q=k(Me,"DIV",{});var le=_(q);K=k(le,"H3",{class:!0});var Be=_(K);pe=ue(Be,"Leerdoel wijzigen"),Be.forEach(g),be=C(le),ee=k(le,"P",{class:!0}),_(ee).forEach(g),le.forEach(g),Me.forEach(g),Te.forEach(g),Se.forEach(g),_e=C(E),B=k(E,"FORM",{class:!0});var ne=_(B);Q(F.$$.fragment,ne),ve=C(ne),X=k(ne,"DIV",{class:!0});var Fe=_(X);Z=k(Fe,"DIV",{class:!0});var Le=_(Z);Q(A.$$.fragment,Le),Le.forEach(g),Fe.forEach(g),ne.forEach(g),E.forEach(g),this.h()},h(){p(t,"fill-rule","evenodd"),p(t,"d","M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"),p(t,"clip-rule","evenodd"),p(l,"class","h-5 w-5 text-yellow-400"),p(l,"xmlns","http://www.w3.org/2000/svg"),p(l,"viewBox","0 0 20 20"),p(l,"fill","currentColor"),p(l,"aria-hidden","true"),p(b,"class","flex-shrink-0"),p(I,"class","text-sm font-medium text-yellow-800"),p(I,"data-test","alert-old-version"),p(y,"class","underline"),p(y,"href",P="/leerdoel/"+a[1].goalId+"/wijzigen"),p(s,"class","mt-2 text-sm text-yellow-700"),p(z,"class","ml-3"),p(d,"class","flex"),p(n,"class","rounded-md bg-yellow-50 p-4"),p(K,"class","text-lg leading-6 font-medium text-gray-900"),p(ee,"class","mt-1 max-w-2xl text-sm text-gray-500"),p(Y,"class","flex-1 min-w-0"),p(N,"class","mt-2 md:flex md:items-center md:justify-between"),p(Z,"class","flex ml-3 justify-end"),p(X,"class","pt-5"),p(B,"class","space-y-8 divide-y divide-gray-200")},m(m,E){ce(m,o,E),U(e,o,null),u(o,r),u(o,n),u(n,d),u(d,b),u(b,l),u(l,t),u(d,f),u(d,z),u(z,I),u(I,T),u(z,R),u(z,s),u(s,h),u(h,c),u(s,v),u(s,j),u(j,y),u(y,L),u(o,ie),U(M,o,null),u(o,ge),u(o,$),u($,N),u(N,Y),u(Y,q),u(q,K),u(K,pe),u(q,be),u(q,ee),u(o,_e),u(o,B),U(F,B,null),u(B,ve),u(B,X),u(X,Z),U(A,Z,null),te=!0,we||(je=Oe(B,"submit",xe(a[3])),we=!0)},p(m,E){const se={};!i&&E&2&&(i=!0,se.revision=m[1],H(()=>i=!1)),e.$set(se),(!te||E&2&&P!==(P="/leerdoel/"+m[1].goalId+"/wijzigen"))&&p(y,"href",P);const G={};!me&&E&4&&(me=!0,G.alert=m[2],H(()=>me=!1)),M.$set(G);const re={};!he&&E&2&&(he=!0,re.goal=m[1],H(()=>he=!1)),F.$set(re)},i(m){te||(D(e.$$.fragment,m),D(M.$$.fragment,m),D(F.$$.fragment,m),D(A.$$.fragment,m),te=!0)},o(m){S(e.$$.fragment,m),S(M.$$.fragment,m),S(F.$$.fragment,m),S(A.$$.fragment,m),te=!1},d(m){m&&g(o),x(e),x(M),x(F),x(A),we=!1,je()}}}function ut(a){let o=!1,e=()=>{o=!1},i,r,n,d,b;Ue(a[7]);let l=a[1]&&Ye(a);return{c(){l&&l.c(),r=de()},l(t){l&&l.l(t),r=de()},m(t,f){l&&l.m(t,f),ce(t,r,f),n=!0,d||(b=Oe(window,"scroll",()=>{o=!0,clearTimeout(i),i=setTimeout(e,100),a[7]()}),d=!0)},p(t,[f]){f&1&&!o&&(o=!0,clearTimeout(i),scrollTo(window.pageXOffset,t[0]),i=setTimeout(e,100)),t[1]?l?(l.p(t,f),f&2&&D(l,1)):(l=Ye(t),l.c(),D(l,1),l.m(r.parentNode,r)):l&&(We(),S(l,1,1,()=>{l=null}),Ne())},i(t){n||(D(l),n=!0)},o(t){S(l),n=!1},d(t){l&&l.d(t),t&&g(r),d=!1,b()}}}function Ke(){return{success:!1,successMessage:"",error:!1,errorCode:"",errorMessage:""}}function ct(a,o,e){let i;ke(a,et,c=>e(12,i=c));let{battleCol:r}=o,{firebase:n}=o,d,{revisionRef:b}=o,l,t,f=Ke();$e(async()=>{l=await b.get(),l.exists&&(e(1,t=l.data()),e(1,t.revisionId=b.id,t),t.goalLinks||e(1,t.goalLinks=[],t),t.unitopic||e(1,t.unitopic="",t),t.multitopics||e(1,t.multitopics=[],t),t.context||e(1,t.context="",t),t.selectedVerbs||e(1,t.selectedVerbs=[],t),t.fromText||e(1,t.fromText="",t),t.battles||e(1,t.battles=[],t)),(await r.get()).forEach(v=>{let j=v.data();j.name=v.id,e(1,t.battles=[...t.battles,j],t)})});async function z(){const c=await n.firestore();let v=ot(t,i.serverFirestoreTimeStamp);e(2,f=Ke());try{if(i.user&&i.player.curriculumProfileId){let j=c.collection("goals").doc(t.goalId);await j.update(v);for(let y=0;y<t.battles.length;y++){let L=c.doc("/goals/"+j.id+"/battles/"+t.battles[y].name),P={quizzes:t.battles[y].quizzes};(await L.get()).exists?await L.update(P):await L.set(P)}v.authorId=i.player.curriculumProfileId,v.goalId=j.id,await lt(c,t,v,i.user.uid,n),e(2,f.success=!0,f),e(2,f.successTitle="Leerdoel gewijzigd",f),e(2,f.successMessage="id: "+j.id,f)}}catch(j){console.error("Error adding document: ",j),e(2,f.error=!0,f),e(2,f.errorCode=j.code,f),e(2,f.errorMessage=j.message,f)}e(0,d=0)}async function I(c){await z()}function T(){e(0,d=window.pageYOffset)}function R(c){t=c,e(1,t)}function s(c){f=c,e(2,f)}function h(c){t=c,e(1,t)}return a.$$set=c=>{"battleCol"in c&&e(4,r=c.battleCol),"firebase"in c&&e(5,n=c.firebase),"revisionRef"in c&&e(6,b=c.revisionRef)},[d,t,f,I,r,n,b,T,R,s,h]}class dt extends Pe{constructor(o){super();qe(this,o,ct,ut,Ae,{battleCol:4,firebase:5,revisionRef:6})}}function Xe(a){let o,e,i,r,n,d,b,l;function t(s){a[8](s)}let f={title:a[3].title};a[4]!==void 0&&(f.breadcrumbs=a[4]),o=new ft({props:f}),O.push(()=>W(o,"breadcrumbs",t));function z(s){a[9](s)}function I(s){a[10](s)}function T(s){a[11](s)}let R={};return a[1]!==void 0&&(R.revisionRef=a[1]),a[2]!==void 0&&(R.battleCol=a[2]),a[0]!==void 0&&(R.firebase=a[0]),r=new dt({props:R}),O.push(()=>W(r,"revisionRef",z)),O.push(()=>W(r,"battleCol",I)),O.push(()=>W(r,"firebase",T)),{c(){J(o.$$.fragment),i=V(),J(r.$$.fragment)},l(s){Q(o.$$.fragment,s),i=C(s),Q(r.$$.fragment,s)},m(s,h){U(o,s,h),ce(s,i,h),U(r,s,h),l=!0},p(s,h){const c={};h&8&&(c.title=s[3].title),!e&&h&16&&(e=!0,c.breadcrumbs=s[4],H(()=>e=!1)),o.$set(c);const v={};!n&&h&2&&(n=!0,v.revisionRef=s[1],H(()=>n=!1)),!d&&h&4&&(d=!0,v.battleCol=s[2],H(()=>d=!1)),!b&&h&1&&(b=!0,v.firebase=s[0],H(()=>b=!1)),r.$set(v)},i(s){l||(D(o.$$.fragment,s),D(r.$$.fragment,s),l=!0)},o(s){S(o.$$.fragment,s),S(r.$$.fragment,s),l=!1},d(s){x(o,s),s&&g(i),x(r,s)}}}function mt(a){let o,e,i=a[0]&&a[1]&&a[3]&&Xe(a);return{c(){i&&i.c(),o=de()},l(r){i&&i.l(r),o=de()},m(r,n){i&&i.m(r,n),ce(r,o,n),e=!0},p(r,[n]){r[0]&&r[1]&&r[3]?i?(i.p(r,n),n&11&&D(i,1)):(i=Xe(r),i.c(),D(i,1),i.m(o.parentNode,o)):i&&(We(),S(i,1,1,()=>{i=null}),Ne())},i(r){e||(D(i),e=!0)},o(r){S(i),e=!1},d(r){i&&i.d(r),r&&g(o)}}}function gt(a,o,e){let i,r;ke(a,tt,s=>e(6,i=s)),ke(a,nt,s=>e(7,r=s));let n,d,b,l,t=!1,f;function z(s){f=s,e(4,f)}function I(s){d=s,e(1,d),e(7,r),e(5,t),e(0,n),e(6,i)}function T(s){b=s,e(2,b),e(7,r),e(5,t),e(0,n),e(6,i),e(1,d)}function R(s){n=s,e(0,n),e(7,r),e(5,t),e(6,i),e(1,d)}return a.$$.update=()=>{a.$$.dirty&227&&(async()=>{if(r&&!t){e(5,t=!0),e(0,n=r);let s=await n.firestore();e(1,d=s.collection("revisions").doc(i.params.id)),e(2,b=s.collection("revisions/"+i.params.id+"/battles"));let h=await d.get();if(h.exists){let c=h.data();c.revisionId=d.id;let v=await s.collection("goals").doc(c.goalId).get();v.exists&&(e(3,l=v.data()),e(3,l.id=c.goalId,l))}}})()},[n,d,b,l,f,t,i,r,z,I,T,R]}class Tt extends Pe{constructor(o){super();qe(this,o,gt,mt,Ae,{})}}export{Tt as default};
