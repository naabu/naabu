import{S as z,i as B,s as G,t as _,$ as J,k as L,l as E,g as y,a0 as M,n as W,f as b,h as R,e as X,c as Y,a as Z,d as m,b as v,F as q,O as T,K as H}from"./vendor-05d04a9e.js";import{s as x}from"./stores-e07732fe.js";import{f as p}from"./store-fa4e989c.js";function P(f){let l,e,n,c,o,r,s=f[0]&&f[2]&&g(f);return{c(){l=_("Now cleaning up the "),e=_(f[1]),n=_(`.
  `),c=new J,o=L(),s&&s.c(),r=E(),this.h()},l(i){l=y(i,"Now cleaning up the "),e=y(i,f[1]),n=y(i,`.
  `),c=M(i),o=W(i),s&&s.l(i),r=E(),this.h()},h(){c.a=o},m(i,u){b(i,l,u),b(i,e,u),b(i,n,u),c.m(ee,i,u),b(i,o,u),s&&s.m(i,u),b(i,r,u)},p(i,u){u&2&&R(e,i[1]),i[0]&&i[2]?s?s.p(i,u):(s=g(i),s.c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d(i){i&&m(l),i&&m(e),i&&m(n),i&&c.d(),i&&m(o),s&&s.d(i),i&&m(r)}}}function g(f){let l,e,n,c;return{c(){l=X("div"),e=_("The "),n=_(f[1]),c=_(" are cleared"),this.h()},l(o){l=Y(o,"DIV",{"data-test":!0});var r=Z(l);e=y(r,"The "),n=y(r,f[1]),c=y(r," are cleared"),r.forEach(m),this.h()},h(){v(l,"data-test","complete")},m(o,r){b(o,l,r),q(l,e),q(l,n),q(l,c)},p(o,r){r&2&&R(n,o[1])},d(o){o&&m(l)}}}function $(f){let l,e=(f[3].environment==="cypress"||f[3].environment==="test"||f[3].environment==="development")&&P(f);return{c(){e&&e.c(),l=E()},l(n){e&&e.l(n),l=E()},m(n,c){e&&e.m(n,c),b(n,l,c)},p(n,[c]){n[3].environment==="cypress"||n[3].environment==="test"||n[3].environment==="development"?e?e.p(n,c):(e=P(n),e.c(),e.m(l.parentNode,l)):e&&(e.d(1),e=null)},i:T,o:T,d(n){e&&e.d(n),n&&m(l)}}}let ee="<br> feedback: <br>";function te(f,l,e){let n,c;H(f,p,t=>e(16,n=t)),H(f,x,t=>e(3,c=t));let{collection:o}=l,{userCheck:r=!0}=l,{fieldUserId:s="authorId"}=l,{idCheck:i=!1}=l,{subcollectionDelete:u=!1}=l,{subcollection:A}=l,{ids:k}=l,{checkAnon:F=!0}=l,{uid:C=null}=l,{titleCheck:N=!1}=l,{title:I=null}=l,w,{resetDone:S=!1}=l,{showComplete:Q=!0}=l,h;async function K(){try{if(c.user.uid){let t=h.collection(o);r&&(C==null&&e(4,C=c.user.uid),t=h.collection(o).where(s,"==",C)),i&&k&&k.length>0&&(t=h.collection(o).where(w.firestore.FieldPath.documentId(),"in",k)),N&&I!==null&&(t=h.collection(o).where("title","==",I));let U=await t.get(),d=[];U.forEach(a=>{d.push(a.id)});for(let a=0;a<d.length;a++)await h.collection(o).doc(d[a]).delete()}}catch(t){console.error(t)}e(0,S=!0)}async function O(){try{if(c.user.uid){let U=await h.collection(o).get(),d=[];U.forEach(a=>{d.push(a.id)});for(let a=0;a<d.length;a++){let V=await h.collection(o).doc(d[a]).collection(A).where(w.firestore.FieldPath.documentId(),"in",k).get(),j=[];V.forEach(D=>{j.push(D.id)});for(let D=0;D<j.length;D++)await h.collection(o).doc(d[a]).collection(A).doc(j[D]).delete()}}}catch(t){console.error(t)}e(0,S=!0)}return f.$$set=t=>{"collection"in t&&e(1,o=t.collection),"userCheck"in t&&e(5,r=t.userCheck),"fieldUserId"in t&&e(6,s=t.fieldUserId),"idCheck"in t&&e(7,i=t.idCheck),"subcollectionDelete"in t&&e(8,u=t.subcollectionDelete),"subcollection"in t&&e(9,A=t.subcollection),"ids"in t&&e(10,k=t.ids),"checkAnon"in t&&e(11,F=t.checkAnon),"uid"in t&&e(4,C=t.uid),"titleCheck"in t&&e(12,N=t.titleCheck),"title"in t&&e(13,I=t.title),"resetDone"in t&&e(0,S=t.resetDone),"showComplete"in t&&e(2,Q=t.showComplete)},f.$$.update=()=>{f.$$.dirty&81920&&(async()=>{n&&(e(14,w=n),e(15,h=await w.firestore()))})(),f.$$.dirty&35080&&(async()=>{(c.environment==="cypress"||c.environment==="test"||c.environment==="development")&&h&&c.player&&c.user&&(!F||!c.user.isAnonymous)&&(u?await O():await K())})()},[S,o,Q,c,C,r,s,i,u,A,k,F,N,I,w,h,n]}class oe extends z{constructor(l){super();B(this,l,te,$,G,{collection:1,userCheck:5,fieldUserId:6,idCheck:7,subcollectionDelete:8,subcollection:9,ids:10,checkAnon:11,uid:4,titleCheck:12,title:13,resetDone:0,showComplete:2})}}export{oe as C};
